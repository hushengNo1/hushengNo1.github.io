(window.webpackJsonp=window.webpackJsonp||[]).push([[51],{530:function(r,t,e){"use strict";e.r(t);var a=e(45),s=Object(a.a)({},(function(){var r=this,t=r.$createElement,e=r._self._c||t;return e("ContentSlotsDistributor",{attrs:{"slot-key":r.$parent.slotKey}},[e("h1",{attrs:{id:"音视频"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#音视频"}},[r._v("#")]),r._v(" 音视频")]),r._v(" "),e("h2",{attrs:{id:"视频流协议"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#视频流协议"}},[r._v("#")]),r._v(" 视频流协议")]),r._v(" "),e("h3",{attrs:{id:"hls"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#hls"}},[r._v("#")]),r._v(" HLS")]),r._v(" "),e("ul",[e("li",[r._v("苹果公司实现的基于 HTTP 的流媒体传输协议，全称 HTTP Live Streaming")]),r._v(" "),e("li",[r._v("HLS（HTTP Live Streaming）->"),e("a",{attrs:{href:"https://www.zhihu.com/search?q=%E7%BC%93%E5%AD%98ts%E6%96%87%E4%BB%B6&search_source=Entity&hybrid_search_source=Entity&hybrid_search_extra=%7B%22sourceType%22%3A%22answer%22%2C%22sourceId%22%3A2474955067%7D",target:"_blank",rel:"noopener noreferrer"}},[r._v("缓存ts文件"),e("OutboundLink")],1),r._v("，同时服务器会建立一个"),e("a",{attrs:{href:"https://www.zhihu.com/search?q=m3u8&search_source=Entity&hybrid_search_source=Entity&hybrid_search_extra=%7B%22sourceType%22%3A%22answer%22%2C%22sourceId%22%3A2474955067%7D",target:"_blank",rel:"noopener noreferrer"}},[r._v("m3u8"),e("OutboundLink")],1),r._v("的索引文件来维护最新的"),e("a",{attrs:{href:"https://www.zhihu.com/search?q=ts%E7%89%87%E6%AE%B5&search_source=Entity&hybrid_search_source=Entity&hybrid_search_extra=%7B%22sourceType%22%3A%22answer%22%2C%22sourceId%22%3A2474955067%7D",target:"_blank",rel:"noopener noreferrer"}},[r._v("ts片段"),e("OutboundLink")],1)]),r._v(" "),e("li",[r._v("一个ts文件大概是一个10秒的视频片段")]),r._v(" "),e("li",[e("strong",[r._v("实时性差")]),r._v("：实际情况下会有2-3个ts文件的延时，大概是20~30s."),e("strong",[r._v("很少用HLS做为互联网直播的传输协议。")])]),r._v(" "),e("li",[e("strong",[r._v("切换码率快")]),r._v("（清晰度）：自带多码率自适应，客户端可以选择从许多不同的备用源中以不同的速率下载同样的资源，允许流媒体会话适应>不同的数据速率。客户端可以很快的选择和切换码率，以适应不同带宽条件下的播放。")])]),r._v(" "),e("h3",{attrs:{id:"rtmp"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#rtmp"}},[r._v("#")]),r._v(" RTMP")]),r._v(" "),e("ul",[e("li",[e("strong",[r._v("实时消息传输协议")]),r._v("，Real Time Messaging Protocol")]),r._v(" "),e("li",[r._v("Adobe Systems 公司为 Flash 播放器和服务器之间音频、视频和数据传输开发的开放协议,"),e("strong",[r._v("协议基于 TCP")])]),r._v(" "),e("li",[r._v("RTMP中的基本数据单元称为"),e("strong",[r._v("消息")]),r._v("（Message），传输的过程中消息会被拆分为更小的"),e("strong",[r._v("消息块")]),r._v("（Chunk）单元，再将分割后的消息块通过 TCP 协议传输，接收端再将接收到的消息块恢复成"),e("strong",[r._v("流媒体数据")]),r._v("。")]),r._v(" "),e("li",[r._v("RTMP协议一般传输的是 flv，f4v 格式流（注意："),e("strong",[r._v("RTMP 是协议")]),r._v("，flv、"),e("a",{attrs:{href:"https://www.zhihu.com/search?q=f4v&search_source=Entity&hybrid_search_source=Entity&hybrid_search_extra=%7B%22sourceType%22%3A%22answer%22%2C%22sourceId%22%3A2474955067%7D",target:"_blank",rel:"noopener noreferrer"}},[r._v("f4v"),e("OutboundLink")],1),r._v(" 是"),e("strong",[r._v("视频封装格式")]),r._v("）")]),r._v(" "),e("li",[e("strong",[r._v("延时较短")]),r._v("，一般延时在 1-3s 之间，应用在直播领域")]),r._v(" "),e("li",[r._v("RTMP 是专为流媒体开发的协议，对底层的优化比其它协议更加优秀，同时它 Adobe Flash 支持好，基本上所有的编码器（摄像头之类）都支持 RTMP 输出。支持 Flash 的浏览器都能播放 RTMP 协议传输的流。")]),r._v(" "),e("li",[r._v("RTMP 为 Adobe "),e("a",{attrs:{href:"https://www.zhihu.com/search?q=%E7%A7%81%E6%9C%89%E5%8D%8F%E8%AE%AE&search_source=Entity&hybrid_search_source=Entity&hybrid_search_extra=%7B%22sourceType%22%3A%22answer%22%2C%22sourceId%22%3A2474955067%7D",target:"_blank",rel:"noopener noreferrer"}},[r._v("私有协议"),e("OutboundLink")],1),r._v("，很多设备无法播放，特别是在 iOS 端，需要使用"),e("strong",[r._v("第三方解码器")]),r._v("才能播放")]),r._v(" "),e("li",[r._v("直接播放 RTMP 流需要浏览器支持 Flash。")])]),r._v(" "),e("h3",{attrs:{id:"http-flv"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#http-flv"}},[r._v("#")]),r._v(" HTTP-FLV")]),r._v(" "),e("p",[r._v("传统的直播协议要么使用 Adobe 的基于 TCP 的 RTMP 协议，要么使用 Apple 的基于 HTTP 的 HLS 协议。\nHTTP-FLV则是结合了 RTMP 的低延时，以及能够复用现有 HTTP 分发资源的流式协议 。")]),r._v(" "),e("p",[r._v("参考："),e("a",{attrs:{href:"http://www.javashuo.com/article/p-oiardnlm-w.html",target:"_blank",rel:"noopener noreferrer"}},[r._v("直播协议 HTTP-FLV 详解"),e("OutboundLink")],1)]),r._v(" "),e("ul",[e("li",[r._v("基于HTTP流式IO传输FLV，依赖浏览器支持播放FLV")]),r._v(" "),e("li",[r._v("HTTP-FLV，即将音视频数据封装成 FLV，而后经过 HTTP 协议传输给客户端。")]),r._v(" "),e("li",[r._v("理论上（除去网络延迟外），FLV 能够作到仅仅一个音视频 tag 的延迟。")])]),r._v(" "),e("h3",{attrs:{id:"项目中使用情况"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#项目中使用情况"}},[r._v("#")]),r._v(" 项目中使用情况")]),r._v(" "),e("ol",[e("li",[e("p",[r._v("视频回传功能：")]),r._v(" "),e("ul",[e("li",[e("p",[r._v("回传视频的设备有唯一推流地址（rtmp协议）")])]),r._v(" "),e("li",[e("p",[r._v("RTMP 转 HTTP-FLV 用于 WEB 播放")]),r._v(" "),e("ul",[e("li",[e("p",[r._v("nginx 、 nginx-http-flv-module")])]),r._v(" "),e("li",[e("p",[r._v("参考："),e("a",{attrs:{href:"https://blog.csdn.net/syy014799/article/details/121884900",target:"_blank",rel:"noopener noreferrer"}},[r._v("直播流转码 RTMP 转 HTTP-FLV 用于 WEB 播放解决流程"),e("OutboundLink")],1)])])])])])])]),r._v(" "),e("h2",{attrs:{id:"一些实践"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#一些实践"}},[r._v("#")]),r._v(" 一些实践")]),r._v(" "),e("ol",[e("li",[r._v("可以通过Nginx代理的方式用https访问http协议的视频流。")]),r._v(" "),e("li",[r._v("因各主流浏览器（Chrome、IE等）将于2020年12月起不再支持 Flash 插件，故 RTMP 实时视频播放器将会停止使用。")])]),r._v(" "),e("h2",{attrs:{id:"解决方案"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#解决方案"}},[r._v("#")]),r._v(" 解决方案")]),r._v(" "),e("ol",[e("li",[e("a",{attrs:{href:"https://blog.csdn.net/weixin_38238552/article/details/118379672",target:"_blank",rel:"noopener noreferrer"}},[r._v("解决网页视频最大只能播放6路的问题"),e("OutboundLink")],1)]),r._v(" "),e("li",[r._v("流媒体解决方案liveqing")]),r._v(" "),e("li",[e("a",{attrs:{href:"http://dplayer.js.org/zh/guide.html",target:"_blank",rel:"noopener noreferrer"}},[r._v("DPlayer播放器"),e("OutboundLink")],1),r._v(" "),e("ol",[e("li",[e("a",{attrs:{href:"https://blog.csdn.net/ah_biao/article/details/116997540",target:"_blank",rel:"noopener noreferrer"}},[r._v("react实现前端播放m3u8格式视频"),e("OutboundLink")],1)]),r._v(" "),e("li",[e("a",{attrs:{href:"https://blog.csdn.net/nuoyan3327/article/details/121343489",target:"_blank",rel:"noopener noreferrer"}},[r._v("DPlayer m3u8格式直播暂停/关闭后停止缓存请求"),e("OutboundLink")],1)]),r._v(" "),e("li")])])])])}),[],!1,null,null,null);t.default=s.exports}}]);